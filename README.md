# dorbit-slackbot
A webserver written in Node.js that functions as a Slack bot for sending messages to a team.

## Dependencies

To install all dependencies for this project, navigate to the project directory and run

`npm install`

Once it completes, you will need to make a copy of `.env.sample` and name it `.env`. The top 3 values are only used in `redbird.js` for obtaining a certificate. You can leave these blank if you dont want to use redbird. 

The first two values are found within your app settings on [api.slack.com](https://api.slack.com/).

- `SLACK_ACCESS_TOKEN` is the OAuth access token generated by Slack when you install your app to your team.
- `SLACK_VERIFICATION_TOKEN` is used to verify that requests to this webserver are coming from Slack. This should be listed as an App Credential under the Basic Information section of your Slack app.
- `SOURCE_TOKEN` can be any string, but is used to verify that a request to `/ring` is coming from a valid source. The companion Python script should send this as part of the request.

## Running

To run the server, use

`npm start`

You should see some debug messages print out, and the server should be up and running. 

## Using redbird

[Redbird](https://github.com/OptimalBits/redbird) is a reverse proxy which has built in support for [Letâ€™s Encrypt](https://letsencrypt.org/), a free Certificate Authority. If you fill in the top three entries in `.env`, redbird will automatically fetch and install a certificate for you. 
- `DOMAIN` is the address you want the certificate to cover
- `CERT_EMAIL` is the email to associate with the certificate
- `CERT_PRODUCTION_MODE` will fetch an invalid certificate if not set to true, but will also prevent you from being banned by Let's Encrypt for too many invalid requests if your redbird config is incorrect. 

In our case, redbird listens for requests on port `80` and `443` and forwards them to the node server running on `9001`. If you would like to run redbird as well, use

`sudo node redbird.js`

Running node as root allows redbird to bind to port 80 and 443, which is required for the Let's Encrypt verification process.